\chapter{Bases and coordinates}

\section{Bases}

If $\calV$ is a subset of $V$, the \keyword{span} of $\calV$, denoted $\Span\calV$ or $\gen{\calV}$, is the smallest subspace of $V$ containing $\calV$. Equivalently, it is the set of all linear combinations
%
\begin{equation*}
    \alpha_1 v_1 + \cdots + \alpha_n v_n,
\end{equation*}
%
where $\alpha_i \in \fieldF$ and $v_i \in \calV$. We say that $\calV$ is \keyword{linearly independent} if any linear relation
%
\begin{equation*}
    \alpha_1 v_1 + \cdots + \alpha_n v_n = 0
\end{equation*}
%
among elements $v_i$ in $\calV$ can only be satisfied if $\alpha_1 = \cdots = \alpha_n = 0$. If $\calV$ is both linearly independent and a spanning set, then we call it a \keyword{basis} for $V$. We have the following characterisation of bases:

\begin{propositionnoproof}
    A subset $\calV \subseteq V$ is a basis for $V$ if and only if
    %
    \begin{equation*}
        V
            = \bigdirsum_{v \in \calV} \gen{v}.
    \end{equation*}
\end{propositionnoproof}

We next prove that bases always exist, but first we need a different characterisation of bases. An element $v \in V$ is an \keyword{essentially unique} linear combination of the elements in $\calV$ if there is an up to ordering unique way to express $v$ as a linear combination of elements in $\calV$. It is easy to see that $\calV$ is linearly independent if and only if every nonzero $v \in \gen{\calV}$ is an essentially unique linear combination of the elements in $\calV$.

\begin{proposition}
    Let $\calV$ be a subset of $V$. The following are equivalent:
    %
    \begin{enumproposition}
        \item \label{enum:linearly-independent-and-span} $\calV$ is linearly independent and spans $V$.
        \item \label{enum:essentially-unique-linear-combination} Every nonzero $v \in V$ is an essentially unique linear combination of vectors in $\calV$.
        \item \label{enum:minimal-spanning-set} $\calV$ is a minimal spanning set.
        \item \label{enum:maximal-linearly-independent-set} $\calV$ is a maximal linearly independent set.
    \end{enumproposition}
\end{proposition}

\begin{proof}
\begin{proofsec*}
    \item[\itemref{enum:linearly-independent-and-span} $\iff$ \itemref{enum:essentially-unique-linear-combination}]
    This follows easily as mentioned above.

    \item[\itemref{enum:linearly-independent-and-span} $\iff$ \itemref{enum:minimal-spanning-set}]
    If \itemref{enum:linearly-independent-and-span} holds and a proper subset $\calV'$ of $\calV$ spanned $V$, then any element of $\calV \setminus \calV'$ is a linear combination of elements in $\calV'$, so $\calV$ is not linearly independent. Conversely, if $\calV$ is a minimal spanning set but is not linearly independent, then some $v \in \calV$ is a linear combination of the other elements in $\calV$, so $\calV \setminus \{v\}$ is also a spanning set.

    \item[\itemref{enum:linearly-independent-and-span} $\iff$ \itemref{enum:maximal-linearly-independent-set}]
    Again assuming \itemref{enum:linearly-independent-and-span}, if $\calV$ were not maximal there would be some $v \in V \setminus \calV$ such that $\calV \union \{v\}$ were linearly independent. But then $v$ would not be a linear combination of elements in $\calV$. Conversely, if $\calV$ is a maximal linearly independent set that did not span $V$, then there would be some $v \in V \setminus \calV$ that is not a linear combination of elements in $\calV$. But then $\calV \union \{v\}$ is also linearly independent.
\end{proofsec*}
\end{proof}


\begin{theorem}
    \label{prop:basis-existence}
    Let $V$ be a vector space. If $\calI \subseteq V$ is linearly independent, $\calS \subseteq V$ is a spanning set, and $\calI \subseteq \calS$, then there is a basis $\calV$ for $V$ with $\calI \subseteq \calV \subseteq \calS$.
\end{theorem}

\begin{proof}
    Let $\calA$ be the collection of linearly independent subsets $\calJ$ of $V$ with $\calI \subseteq \calJ \subseteq \calS$. If $\calC$ is a chain in $\calA$, then
    %
    \begin{equation*}
        \calU
            = \bigunion \calC
    \end{equation*}
    %
    is linearly independent and satisfies $\calI \subseteq \calU \subseteq \calS$, so it lies in $\calA$. Hence every chain in $\calA$ has an upper bound, so it has a maximal element $\calV$. This is linearly independent since it lies in $\calA$, and it is also a spanning set by maximality, hence it is a basis.
\end{proof}


\begin{corollary}
    Every vector space has a basis.
\end{corollary}

\begin{proof}
    Let $\calI = \emptyset$ and $\calS = V$ in \cref{prop:basis-existence}.
\end{proof}


We next turn to the concept of the \keyword{dimension} of a vector space. Our presentation will focus on finite-dimensional vector spaces.

\begin{proposition}
    If the vectors $v_1, \ldots, v_n$ in $V$ are linearly independent, and the vectors $w_1, \ldots, w_m$ span $V$, then $n \leq m$.
\end{proposition}

\begin{proof}
    List the vectors as follows:
    %
    \begin{equation*}
        w_1, \ldots, w_m; v_1, \ldots, v_n.
    \end{equation*}
    %
    We transform this list such that the collection of vectors on the left-hand side of the semicolon always span $V$, and such that the vectors on the right-hand side are always linearly independent. Note that $v_1$ is a linear combination of the $w_j$, implying that we may add $v_1$ to the left-hand side and remove one of the $w_j$ (which, by reindexing, we may assume is $w_1$) and still have a spanning set. We simultaneously remove $v_1$ from the right-hand side. That is, we obtain
    %
    \begin{equation*}
        v_1, w_2, \ldots, w_m; v_2, \ldots, v_n.
    \end{equation*}
    %
    If $m < n$, then applying this process recursively will eventually exhaust the $w_j$, at which point we would have
    %
    \begin{equation*}
        v_1, \ldots, v_m; v_{m+1}, \ldots, v_n.
    \end{equation*}
    %
    But this is not possible, since $v_n$ does not lie in the span of $v_1, \ldots, v_m$. Hence $n \leq m$.
\end{proof}


\begin{corollarynoproof}
    If $V$ has a finite spanning set, then all bases for $V$ have the same cardinality.
\end{corollarynoproof}
%
This in fact holds for arbitrary vector spaces, though the proof is significantly more involved (cf. \cite[Theorem~1.12]{romanlinalg}).

Since bases always exist and all bases have the same cardinality, the following definition makes sense:

\begin{definition}[Dimension]
    The \keyword{dimension} of a vector space $V$, written $\dim V$, is the cardinality of any basis for $V$.
\end{definition}


We now turn to a different characterisation of the dimension of finite-dimensional vector spaces. Below we write $\dim V = \infty$ if the dimension of the vector space $V$ is infinite. A \keyword{series} of subspaces $U_i$ of $V$ is a finite or infinite decreasing sequence
%
\begin{equation*}
    V
        = U_0
        \supsetneq U_1
        \supsetneq U_2
        \supsetneq \cdots.
\end{equation*}
%
If the sequence is finite, then the \keyword{length} of the series is the number of strict inclusions. If the sequence is infinite, then we say that the length of the series is $\infty$. The maximal length of a series of subspaces of $V$ is denoted $l(V)$.

In the proposition below, we write $\dim V = \infty$ if the dimension of $V$ is infinite.

\begin{proposition}
    Let $V$ be a vector space. Then $\dim V = l(V)$.
\end{proposition}

\begin{proof}
    First assume that $V$ is finite-dimensional, and let $\calV = (v_1, \ldots, v_n)$ be a basis for $V$. Then there is a series
    %
    \begin{equation*}
        V
            = \gen{v_1, \ldots, v_n}
            \supsetneq \gen{v_1, \ldots, v_{n-1}}
            \supsetneq \cdots
            \supsetneq \gen{v_1}
            \supsetneq 0
    \end{equation*}
    %
    of subspaces of $V$, so $\dim V \leq l(V)$. Conversely, let
    %
    \begin{equation*}
        V
            = U_0
            \supsetneq U_1
            \supsetneq U_2
            \supsetneq \cdots
    \end{equation*}
    %
    be a series of subspaces of $V$. If the series ends with $0$, remove it. Hence all subspaces in the series are nontrivial. Then choose for each $i$ an element $v_i \in U_i \setminus U_{i+1}$, and collect them in a set $\calI$. It is clear that $\calI$ is linearly independent, hence finite. Thus the series is also finite with length $\card{\calI}-1$. Adding back $0$ to the series we obtain a series that is at least as long as the original sequence, and that is of length $\card{\calI} \leq \dim V$. Since the sequence was arbitrary, $l(V) \leq \dim V$.

    Next assume that $V$ is infinite-dimensional. Then $V$ contains a sequence $(v_i)_{i\in\naturals}$ that is linearly independent, so the series
    %
    \begin{equation*}
        V
            \supseteq \genset{v_i}{i \in \naturals}
            \supsetneq \genset{v_i}{i \geq 2}
            \supsetneq \genset{v_i}{i \geq 3}
            \supsetneq \cdots
    \end{equation*}
    %
    is infinite, and $l(V) = \infty$. Conversely, assume that $V$ has an infinite series. As above we construct a linearly independent set $\calI$ whose size equals the length of the sequence. Thus $V$ contains an infinite linearly independent set, so $\dim V = \infty$.
\end{proof}


\section{Coordinate maps and matrices}

Every matrix $A \in \mat{m,n}{\fieldF}$ gives rise to a map $M_A \colon \fieldF^n \to \fieldF^m$ given by $M_A v = Av$. The next result shows that every linear map $\fieldF^n \to \fieldF^m$ arises in this way:

\begin{proposition}
    \label{prop:smr-properties}
    Let $(e_1, \ldots, e_n)$ be the standard basis for $\fieldF^n$. The map
    %
    \begin{align*}
        \calM \colon \lin(\fieldF^n, \fieldF^m) &\to \mat{m,n}{\fieldF}, \\
        T &\mapsto \bigl( Te_1 \mid \cdots \mid Te_n \bigr),
    \end{align*}
    %
    is a linear isomorphism with inverse $A \mapsto M_A$. The matrix $\smr{T}$ is called the \keyword{standard matrix representation} of $T$. If $T \colon \fieldF^n \to \fieldF^m$ and $S \colon \fieldF^m \to \fieldF^l$ are linear maps, then
    %
    \begin{enumproposition}
        \item \label{enum:smr-vector-multiplication} $Tv = \smr{T}v$ for all $v \in \fieldF^n$.
        
        \item \label{enum:smr-of-identity-map} $\smr{\id_{\fieldF^n}} = I$.

        \item \label{enum:smr-multiplicative} $\smr{S \circ T} = \smr{S} \smr{T}$.

        \item \label{enum:smr-invertibility} $T$ is invertible if and only if $\smr{T}$ is invertible, in which case $\smr{\inv{T}} = \inv{\smr{T}}$.
    \end{enumproposition}
\end{proposition}

\begin{proof}
    The map $A \mapsto M_A$ is clearly linear, so to prove the first point it suffices to show that this is the inverse of $\calM$. Let $T \in \lin(\fieldF^n,\fieldF^m)$. Then
    %
    \begin{equation*}
        M_{\smr{T}} \colvec{\alpha_1 \\ \vdots \\ \alpha_n}
            = \smr{T} \colvec{\alpha_1 \\ \vdots \\ \alpha_n}
            = \bigl( Te_1 \mid \cdots \mid Te_n \bigr) \colvec{\alpha_1 \\ \vdots \\ \alpha_n}
            = \sum_{i=1}^n \alpha_i Te_i
            = T \colvec{\alpha_1 \\ \vdots \\ \alpha_n}
    \end{equation*}
    %
    for $\alpha_1, \ldots, \alpha_n \in \fieldF$. Conversely, for $A \in \mat{m,n}{\fieldF}$ we have
    %
    \begin{equation*}
        \smr{M_A}
            = \bigl( M_A e_1 \mid \cdots \mid M_A e_n \bigr)
            = \bigl( A e_1 \mid \cdots \mid A e_n \bigr)
            = A,
    \end{equation*}
    %
    since $Ae_i$ is the $i$th column of $A$. We prove the remaining claims:
    %
    \begin{proofsec}
        \item[\itemref{enum:smr-vector-multiplication}]
        Simply notice that $Tv = M_{\smr{T}}v = \smr{T}v$.

        \item[\itemref{enum:smr-of-identity-map}]
        This is obvious from the definition of $\calM$.

        \item[\itemref{enum:smr-multiplicative}]
        Let $v \in \fieldF^n$ and notice that
        %
        \begin{equation*}
            \smr{S \circ T}v
                = (S \circ T) v
                = S(Tv)
                = S(\smr{T}v)
                = \smr{S}\smr{T}v
        \end{equation*}
        %
        by \itemref{enum:smr-vector-multiplication}. Since this holds for all $v$, the claim follows.

        \item[\itemref{enum:smr-invertibility}]
        This follows easily from \itemref{enum:smr-of-identity-map} and \itemref{enum:smr-multiplicative}.
    \end{proofsec}
\end{proof}


Having characterised all linear maps between powers of the field $\fieldF$, we now wish to characterise the linear maps between abstract finite-dimensional vector spaces. The first order of business is to establish a correspondence between such a vector space and an appropriate power of $\fieldF$.

Let $V$ be a finite-dimensional $\fieldF$-vector space. If $\calV = (v_1, \ldots, v_n)$ is an ordered basis for $V$, then for every $v \in V$ there are unique $\alpha_1, \ldots, \alpha_n \in \fieldF$ such that $v = \sum_{i=1}^n \alpha_i v_i$. Hence the map $\coordmap{\calV} \colon V \to \fieldF^n$ given by $\coordmap{\calV}(v) = (\alpha_1, \ldots, \alpha_n)$ is well-defined. Furthermore, it is clearly linear, and since $\calV$ is a basis it is also bijective, hence a linear isomorphism. The map $\coordmap{\calV}$ is called the \keyword{coordinate map} with respect to $\calV$, and the vector $\coordvec{v}{\calV} = \coordmap{\calV}(v)$ is called the \keyword{coordinate vector} of $v$ with respect to $\calV$.

Now let $\calW$ be another ordered basis for $V$. The composition $\basischange{\calW}{\calV} = \coordmap{\calW} \circ \inv{\coordmap{\calV}}$ is called the \keyword{change of basis operator} from $\calV$ to $\calW$, and this makes the diagram
%
\begin{equation}
    \label{eq:change-of-basis-diagram}
    \begin{tikzcd}[row sep=small]
        & \fieldF^n
            \ar[dd, "\basischange{\calW}{\calV}"] \\
        V
            \ar[ru, "\coordmap{\calV}"]
            \ar[rd, "\coordmap{\calW}", swap] \\
        & \fieldF^n
    \end{tikzcd}
\end{equation}
%
commute. Its standard matrix is denoted $\basischangemat{\calW}{\calV}$. This has the expected properties:

\begin{proposition}
    Let $\calV$, $\calW$ and $\calU$ be ordered bases for a finite-dimensional $\fieldF$-vector space $V$. Then
    %
    \begin{enumproposition}
        \item \label{enum:basis-change-coordvec} $\coordvec{v}{\calW} = \basischange{\calW}{\calV} (\coordvec{v}{\calV})$ for all $v \in V$. In particular, $\coordvec{v}{\calW} = \basischangemat{\calW}{\calV} \cdot \coordvec{v}{\calV}$.

        \item \label{enum:basis-change-identity-map} $\basischange{\calV}{\calV}$ is the identity map. In particular, $\basischangemat{\calV}{\calV}$ is the identity matrix.

        \item $\basischange{\calU}{\calW} \circ \basischange{\calW}{\calV} = \basischange{\calU}{\calV}$. In particular, $\basischangemat{\calU}{\calW} \cdot \basischangemat{\calW}{\calV} = \basischangemat{\calU}{\calV}$.

        \item $\basischange{\calW}{\calV}$ (resp. $\basischangemat{\calW}{\calV}$) is invertible with inverse $\basischange{\calV}{\calW}$ (resp. $\basischangemat{\calV}{\calW}$).
    \end{enumproposition}
\end{proposition}

\begin{proof}
    All claims about change of basis matrices follow by \cref{prop:smr-properties} from the corresponding claims about change of basis operators.

    The claim \itemref{enum:basis-change-coordvec} follows by commutativity of the diagram \cref{eq:change-of-basis-diagram}, i.e.
    %
    \begin{equation*}
        \basischange{\calW}{\calV} (\coordvec{v}{\calV})
            = (\coordmap{\calW} \circ \inv{\coordmap{\calV}}) \circ \coordmap{\calV}(v)
            = \coordmap{\calW}(v)
            = \coordvec{v}{\calW}.
    \end{equation*}
    %
    Claim \itemref{enum:basis-change-identity-map} is an immediate consequence of the definition of $\basischange{\calV}{\calV}$. The remaining claims are proved similarly to \itemref{enum:basis-change-coordvec}.
\end{proof}

Next consider a linear map $T \colon V \to W$. If $\calV \in V^n$ and $\calW \in W^m$ are bases for $V$ and $W$ respectively, then the diagram
%
\begin{equation*}
    \begin{tikzcd}
        V
            \ar[d, "T", swap]
            \ar[r, "\coordmap{\calV}"]
        & \fieldF^n
            \ar[d, "\coordmap{\calW} \circ T \circ \inv{\coordmap{\calV}}"] \\
        W
            \ar[r, "\coordmap{\calW}", swap]
        & \fieldF^m
    \end{tikzcd}
\end{equation*}
%
commutes. The map $\coordmap{\calW} \circ T \circ \inv{\coordmap{\calV}}$ is the \keyword{basis representation} of $T$ with respect to the bases $\calV$ and $\calW$. This is a linear map $\fieldF^n \to \fieldF^m$, so it has a standard matrix which we denote $\mr{\calW}{T}{\calV}$. This is called the \keyword{matrix representation} of $T$ with respect to the bases $\calV$ and $\calW$.

\begin{proposition}
    \label{prop:mr-properties}
    Let $V$ and $W$ be finite-dimensional $\fieldF$-vector spaces with ordered bases $\calV = (v_1, \ldots, v_n) \in V^n$ and $\calW \in W^m$, respectively. The map
    %
    \begin{align*}
        \mr{\calW}{\,\cdot\,}{\calV} \colon \lin(V,W) &\to \mat{m,n}{\fieldF}, \\
        T &\mapsto \mr{\calW}{T}{\calV},
    \end{align*}
    %
    is a linear isomorphism. Let $T \colon V \to W$ and $S \colon W \to U$ be linear maps, and let $\calU \in U^l$ be an ordered basis for $U$. Then
    %
    \begin{enumproposition}
        \item \label{enum:mr-explicit-formula} $\mr{\calW}{T}{\calV} = \bigl( \coordvec{Tv_1}{\calW} \mid \cdots \mid \coordvec{Tv_n}{\calW} \bigr)$.

        \item \label{enum:mr-vector-multiplication} $\coordvec{Tv}{\calW} = \mr{\calW}{T}{\calV} \cdot \coordvec{v}{\calV}$ for all $v \in V$.

        \item \label{enum:mr-of-identity-map} If $\calV'$ is another basis for $V$, then $\mr{\calV'}{\id_V}{\calV} = \basischangemat{\calV'}{\calV}$.

        \item \label{enum:mr-multiplicative} $\mr{\calU}{S \circ T}{\calV} = \mr{\calU}{S}{\calW} \cdot \mr{\calW}{T}{\calV}$.

        \item \label{enum:mr-invertibility} $T$ is invertible if and only if $\mr{\calW}{T}{\calV}$ is invertible, in which case $\mr{\calV}{\inv{T}}{\calW} = \inv{\mr{\calW}{T}{\calV}}$.
    \end{enumproposition}
\end{proposition}

\begin{proof}
    For the first claim, notice that the map $T \mapsto \coordmap{\calW} \circ T \circ \inv{\coordmap{\calV}}$ is a linear isomorphism, since pre- and postcomposition with linear isomorphisms are themselves linear isomorphisms. Composing this map with $\calM$ yields $\mr{\calW}{\,\cdot\,}{\calV}$, so this is a linear isomorphism by \cref{prop:smr-properties}.
    %
    \begin{proofsec}
        \item[\itemref{enum:mr-explicit-formula}]
        If $(e_1, \ldots, e_n)$ is the standard basis for $\fieldF^n$, then the definition of the standard matrix representation yields that the $i$th column of $\mr{\calW}{T}{\calV}$ is given by
        %
        \begin{equation*}
            \mr{\calW}{T}{\calV} \cdot e_i
                = \smr{\coordmap{\calW} \circ T \circ \inv{\coordmap{\calV}}} \cdot e_i
                = (\coordmap{\calW} \circ T \circ \inv{\coordmap{\calV}}) e_i
                = \coordmap{\calW}(Tv_i)
                = \coordvec{Tv_i}{\calW},
        \end{equation*}
        %
        as claimed.

        \item[\itemref{enum:mr-vector-multiplication}]
        Notice that
        %
        \begin{align*}
            \coordvec{Tv}{\calW}
                &= (\coordmap{\calW} \circ T)(v) \\
                &= (\coordmap{\calW} \circ T \circ \inv{\coordmap{\calV}}) \circ \coordmap{\calV}(v) \\
                &= (\coordmap{\calW} \circ T \circ \inv{\coordmap{\calV}})(\coordvec{v}{\calV}) \\
                &= \mr{\calW}{T}{\calV} \cdot \coordvec{v}{\calV}.
        \end{align*}
        %
        where the last equality follows from \cref{enum:smr-vector-multiplication}.

        \item[\itemref{enum:mr-of-identity-map}]
        This is obvious from the definitions of $\mr{\calV'}{\id_V}{\calV}$ and $\basischangemat{\calV'}{\calV}$.

        \item[\itemref{enum:mr-multiplicative}]
        Notice that
        %
        \begin{equation*}
            \coordmap{\calU} \circ (S \circ T) \circ \inv{\coordmap{\calV}}
                = (\coordmap{\calU} \circ S \circ \inv{\coordmap{\calW}}) \circ (\coordmap{\calW} \circ T \circ \inv{\coordmap{\calV}})
        \end{equation*}
        %
        The claim then follows from \cref{enum:smr-multiplicative}.

        \item[\itemref{enum:mr-invertibility}]
        This is an immediate consequence of either \itemref{enum:mr-multiplicative} or of \cref{enum:smr-invertibility}.
    \end{proofsec}
\end{proof}

\begin{proposition}
    Let $\calV = (v_1, \ldots, v_n)$ be an ordered basis for an $\fieldF$-vector space $V$, and let $T \colon V \to V$ be a linear isomorphism. Let $\calW = (w_1, \ldots, w_n)$ where $w_i = Tv_i$. Then $\calW$ is an ordered basis for $V$ and
    %
    \begin{equation*}
        \basischange{\calW}{\calV}
            = \coordmap{\calV} \circ \inv{T} \circ \inv{\coordmap{\calV}},
        \quad \text{or} \quad
        \basischangemat{\calW}{\calV}
            = \mr{\calV}{\inv{T}}{\calV}.
    \end{equation*}
    %
    In particular, if $V = \fieldF^n$ and $\calV$ is the standard basis $\calE$, then
    %
    \begin{equation*}
        \basischange{\calW}{\calE}
            = \inv{T},
        \quad \text{or} \quad
        \basischangemat{\calW}{\calE}
            = \inv{\smr{T}}.
    \end{equation*}
\end{proposition}
%
We think of this result as follows: If we change basis by applying an invertible linear transformation $T$, we obtain the coordinate vectors corresponding to the transformed basis by applying $\inv{T}$ (in the old basis). This says that if we perform a \emph{passive transformation}, i.e. a change of basis while keeping vectors themselves fixed, the coordinates change by the inverse of said transformation.

\begin{proof}
    Let $v \in V$ and write $v = \sum_{i=1}^n \alpha_i v_i$. Then
    %
    \begin{equation*}
        Tv
            = \sum_{i=1}^n \alpha_i Tv_i
            = \sum_{i=1}^n \alpha_i w_i
            = \inv{\coordmap{\calW}} \colvec{\alpha_1 \\ \vdots \\ \alpha_n}
            = \inv{\coordmap{\calW}} \circ \coordmap{\calV}(v),
    \end{equation*}
    %
    implying that
    %
    \begin{equation*}
        \basischange{\calW}{\calV}
            = \coordmap{\calW} \circ \inv{\coordmap{\calV}}
            = (T \circ \inv{\coordmap{\calV}})\inv \circ \inv{\coordmap{\calV}}
            = \coordmap{\calV} \circ \inv{T} \circ \inv{\coordmap{\calV}}
    \end{equation*}
    %
    as claimed.
\end{proof}